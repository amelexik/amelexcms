<?$rate_of_currency = $admin->db->select("SELECT * FROM rate_of_currency");$smarty->assign("rate_of_currency",$rate_of_currency);if (!empty($gAction)){	if ($gAction == "updateRate"){				if ($xmlContent = @file_get_contents("http://pfsoft.com.ua/service/currency/")){			$xmlContent = iconv("windows-1251","utf-8",$xmlContent);			$rss =  simplexml_load_file('http://pfsoft.com.ua/service/currency/');			$rate = array();			foreach ($rss->Valute as $key => $item_val){				$NumCode = (string)$item_val->NumCode;				$CharCode = (string)$item_val->CharCode;				$Nominal = (string)$item_val->Nominal;				$Name = (string)$item_val->Name;				$Value = floatval($item_val->Value);								$is = $admin->db->selectRow("SELECT id FROM rate_of_currency WHERE NumCode='{$NumCode}' AND CharCode='{$CharCode}'");								if (count($is)>0){					$sql = "UPDATE rate_of_currency SET Value='{$Value}' WHERE NumCode='{$NumCode}' AND CharCode='{$CharCode}'";				}				else{					$sql = "INSERT INTO rate_of_currency(NumCode,CharCode,Nominal,Name,Value) VALUES ('{$NumCode}','{$CharCode}','{$Nominal}','{$Name}','{$Value}')";				}				$admin->db->query($sql);				}		}								$back_url = "?section=".$admin->section;		header("location:$back_url");		exit();	}}?>